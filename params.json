{"name":"Cucumber-chef","body":"Cucumber-chef is a library of tools to enable the emerging discipline of infrastructure as code to practice test driven development.  It provides a testing platform within which Cucumber tests can be run which provision virtual machines, configure them by applying the appropriate Chef roles to them, and then run acceptance and integration tests against the environment.\r\n\r\n## Overview\r\n\r\nCucumber-chef begins with a very simple premise.  If we are framing our infrastructure as code - if we're writing cookbooks, recipes and other pieces of automation in a high level programming language, such as Ruby, then it makes sense to follow the current wisdom across the software development world to maximise the quality, maintainability and reusability of our code, providing maximum chance that we'll deliver value with it.  One area which has been shown to have a very positive effect is the practive of 'test-driven' development.  In this paradigm, the developer begins by writing a test that captures the intended behaviour of the code they are going to write.  This test will start out by failing.  The developer then writes code to make the test pass, and iterates thereafter.\r\n\r\nCucumber-chef provides a framework to make it easier to do test-driven development for infrastructure.  It does this by providing a test infrastructure, which we call the \"test lab\", within which a number of different scenarios can be set up, and against which Cucumber features can we run.  From the outset, Cucumber-chef's design was to provide a fast, lightweight and cheap way to fire up virtual machines for testing.  At present this is achieved using Linux Containers on Amazon EC2.  Supporting alternative provisioning backends is planned, which will allow the user to opt to test using local machines, alternative cloud providers, and ultimatey alternative virtualization technologies.\r\n\r\nFor node convergence, Cucumber-Chef uses the open-source Chef server.  It can be configured to use Hosted Chef or Private Chef.  Supoprt for Chef-solo will be included in a future relase.\r\n\r\nAs you might have guessed from the name, we're going to write high level acceptance tests using Cucumber.  Cucumber-Chef provides step definitions and helper methods to make it easy to provision and manage machines with Chef, and then build end-to-end tests.\r\n\r\n## Getting Started\r\n\r\n*LISTEN UP*\r\n\r\nHere's the headline:\r\n\r\nWith a /single command/ Cucumber-Chef will provision a machine, set up an open source Chef server, bootstrap it to support the creation of Linux containers, set up an environment from which to run tests, and automatically configure your system to use it.\r\n\r\nThis means getting started with Cucumber-Chef is a simple, three step process.\r\n\r\n1. Install Cucumber-Chef\r\n2. Run `cucumber-chef init` to configure Cucumber-Chef.\r\n3. Run `cucumber-chef setup` to build your test lab.\r\n\r\n### Installing Cucumber-Chef\r\n\r\nCucumber-Chef is distributed as a RubyGem.  To install it you have two options - stable or development.\r\n\r\n#### Installing the stable version\r\n\r\nSimply install from RubyGems:\r\n\r\n    $ gem install cucumber-chef\r\n\r\nDepending on your local setup (ie whether you're using RVM or rbenv, or distribution-provided Ruby), you may need to run this with superuser privileges.\r\n\r\n#### Installing the development version\r\n\r\nIf you want to try a development version, simply clone this repo, and build the gem yourself:\r\n\r\n    $ git clone git://github.com/Atalanta/cucumber-chef -b BRANCH\r\n    $ cd cucumber-chef\r\n    $ bundle\r\n    $ rake build\r\n    $ gem install pkg/cucumber-chef-VERSION.gem\r\n\r\nAgain, depending on your local setup (ie whether you're using RVM or rbenv, or distribution-provided Ruby), you may need to run parts of this process with superuser privileges.\r\n\r\n### Running `cucumber-chef init`\r\n\r\nCucumber-Chef ships with an initialization task, which will interactively generate configuration file.  This requires you to have, and know your Amazon Web Services credntials.  On completion of the interactive configuration, it will provision a machine on EC2, and set up the entire infrastructure, using Chef.\r\n\r\nCucumber-Chef doesn't demand where you keep your configuration file.  By default, the config will be created in `~/.cucumber-chef`, but this can be overridden.  Cucumber-Chef is clever enough to find your config, so it's all cool.\r\n\r\nThe two obvious places to keep this config, are in the top level of your Chef repository, or in a dedicated Cucumber-Chef repository, but you're free to do whatever works for you.\r\n\r\nYou can view and verify the current config at any time by running `cucumber-chef displayconfig`.  If Cucumber-Chef thinks your config is incorrect, or incomplete, it'll tell you.\r\n\r\n## Using Cucumber-Chef\r\n\r\nOnce installed, you can run `cucumber-chef` on the command line to get an overview of the tasks it can carry out.\r\n\r\n    $ cucumber-chef\r\n    Tasks:\r\n      cucumber-chef create <project>                   # Create a project template for testing an infrastructure.\r\n      cucumber-chef diagnose <container>               # Provide diagnostics from the chef-client on the specified container.\r\n      cucumber-chef displayconfig                      # Display the current cucumber-chef config.\r\n      cucumber-chef help [TASK]                        # Describe available tasks or one specific task\r\n      cucumber-chef info                               # Display information about the current test lab.\r\n      cucumber-chef init                               # Initalize cucumber-chef configuration\r\n      cucumber-chef setup                              # Setup cucumber-chef test lab in Amazon EC2\r\n      cucumber-chef ssh [container]                    # SSH to cucumber-chef test lab or [container] if specified.\r\n      cucumber-chef teardown                           # Teardown cucumber-chef test lab in Amazon EC2\r\n      cucumber-chef test <project> [cucumber-options]  # Test a project using the cucumber-chef test suite.\r\n\r\nAfter tunning set up, which takes about 15 minutes, you'll have a fully funtioning platform available for you to use.  Let's just quickly review what that means.  You will have an EC2 machine, fully managed by Chef, and providing the following:\r\n\r\n* The ability to provision LXC containers\r\n* The ability to run tests against LXC containers\r\n* A dedicated environment for certain kinds of testing scenarios\r\n\r\nThe next stage is to set up a project.  A project is simply a directory structure for containing your cucumber features and steps, already set up with an appropriate environment to make use of the step definitions provided with Cucumber-Chef.  Cucumber-chef provides a task which will create a the directory for you, and populate it with a README and an example feature and steps.  These represent futher documentation, and provide a model and steps to get you up and running with your testing as quickly as possible.\r\n\r\n    $ cd /path/to/chef-repo\r\n    $ cucumber-chef create myproject\r\n\r\nThis will create a directory, cucumber-chef, and a subdirectory, `myproject`.\r\n\r\n    └── myproject\r\n        ├── README\r\n        └── features\r\n            ├── myproject.feature\r\n            ├── step_definitions\r\n            │   └── myproject_steps.rb\r\n            └── support\r\n                └── env.rb\r\n\r\n## Writing Tests\r\n\r\nOnce you've got your test lab set up, and you've generated a project, it's time to crack on with writing a test.  The basic idea is this:\r\n\r\n1. An infrastructure requirement is established\r\n2. Write a cucumber feature that expresses the required behaviour of the infrastructure requirement\r\n3. Write steps that will build this infrastructure environment on the test lab, using the step definitions provided - these include the ability to create a container, apply roles to it, and destroy it again.\r\n4. Write cookbooks and recipes and supporting code to make the test pass\r\n\r\n### Container Details\r\n\r\nAll containers operate off a bridged interface on the test-lab.  All outbound, non-local traffic from the LXC containers are NAT'd through the test-lab and off to the outside world.  This bridged interface on the test-lab is configured as follows:\r\n\r\n    CIDR: 192.168.0.0/16\r\n    IP Address: 192.168.255.254\r\n    Netmask: 255.255.255.0\r\n    Broadcast: 192.168.255.255\r\n\r\nYou are free to use any IP in this /24, with the exception of the test-lab itself, which is at `192.168.255.254`.\r\n\r\n### Built In Test Steps\r\n\r\n#### Provisioning\r\n\r\nWe provide several built in steps to help you with provisioning.  It is suggested you build a `Background` section for your features so these are not repeated with each scenario.  This example `Background` section does the following:\r\n\r\n* Sets up a server called `devopserver`.\r\n* Makes the server persistant (it will remain up after the test finishes, which is the default behaviour).\r\n* Assigns it an IP address on the test lab network (this can be omitted for an auto-assigned IP).\r\n* Tells Cucumber-Chef to provision the server.\r\n* Adds the `chef-client::service` recipe in to the chef-client's run list.\r\n* Executes `chef-client` with the generated run list.\r\n* Starts an SSH session to the server so you can execute commands and test the output of those commands in the scenarios.\r\n\r\nHere is the `Background` section as you might write it in a feature:\r\n\r\n      Background:\r\n        * I have a server called devopserver\r\n        * devopserver is persistant\r\n        * devopserver has an IP address of 192.168.10.10\r\n        * devopserver has been provisioned\r\n        * the chef-client::service recipe has been added to the devopserver run list\r\n        * the chef-client has been run on devopserver\r\n        * I have no public keys set\r\n        * I ssh to devopserver with the following credentials:\r\n          | username | password |\r\n          | root     | root     |\r\n\r\nTo get a persistent server with an auto-assigned IP address you could write something like this:\r\n\r\n      Background:\r\n        * I have a server called devopserver\r\n        * devopserver has been provisioned\r\n        * the chef-client::service recipe has been added to the devopserver run list\r\n        * the chef-client has been run on devopserver\r\n        * I have no public keys set\r\n        * I ssh to devopserver with the following credentials:\r\n          | username | password |\r\n          | root     | root     |\r\n\r\nYou can add roles to the run list by writing:\r\n\r\n        * the chef-client role has been added to the devopserver run list\r\n\r\nHere's an example `Scenario` section you might have to test if the chef-client is actually running as a daemon:\r\n\r\n      Scenario: Chef-Client is running as a daemon\r\n        When I run \"ps aux | grep [c]hef-client\"\r\n          Then I should see \"chef-client\" in the output\r\n          And I should see \"-d\" in the output\r\n          And I should see \"-i 1800\" in the output\r\n          And I should see \"-s 20\" in the output\r\n\r\nSee the section below label *Example Test Run* for more examples.\r\n\r\n##### List of Provisioning Steps\r\n\r\nCreate a server profile:\r\n\r\n    I have a server called (server)\r\n\r\nSet a (server) to persist or not:\r\n\r\n    (server) is (persistant|non-persistant)\r\n\r\nAssign (server) a specific IP address (must be on the test lab network segment):\r\n\r\n    (server) has an IP address of (ip)\r\n\r\nAssign (server) a specific MAC address:\r\n\r\n    (server) has a MAC address of (mac)\r\n\r\nInitiate the provision of a (server):\r\n\r\n    (server) has been provisioned\r\n\r\nAdd a role to the chef-client run list:\r\n\r\n    the (role) role has been added to the (server) run list\r\n\r\nAdd a recipe to the chef-client run list:\r\n\r\n    the (recipe) recipe has been added to the (server) run list\r\n\r\nRun the chef-client:\r\n\r\n    the chef-client has been run on (server)\r\n\r\n#### SSH Steps\r\n\r\nHere is how you might setup and initate an SSH session using password authentication to a server named `devopserver`:\r\n\r\n        * I have no public keys set\r\n        * I ssh to devopserver with the following credentials:\r\n          | username | password |\r\n          | root     | root     |\r\n\r\n##### List of SSH Steps\r\n\r\nSets the authentication method to password:\r\n\r\n    I have no public keys set\r\n\r\nStart an SSH session to the server (server):\r\n\r\n    I ssh to (server) with the following credentials:\r\n      | username | password |\r\n      | root     | root     |\r\n\r\n\r\nExecutes (command) over the previously established SSH session on the server (server):\r\n\r\n    I run \"(command)\"\r\n\r\nCheck (command) output for an (expected) or (not-expected) string:\r\n\r\n    I should see \"(expected)\" in the output\r\n    I should not see \"(not-expected)\" in the output\r\n\r\nCheck (command) output for existance of or lack of (server) settings:\r\n\r\n    I should see the (ip|mac) of (server) in the output\r\n    I should not see the (ip|mac) of (server) in the output\r\n\r\n#### Cucumber Before Hook Centric Helpers\r\n\r\n* `chef_set_client_config(config={})`\r\n\r\nThis method configures the chef-client's `client.rb` file.  Currently you can specify `:orgname`, `:log_level`, `:log_location`, `:chef_server_url` and `:validation_client_name`.  See your `env.rb` file if you need to change this to point it at a Hosted Chef Server or need to modify any of these values.\r\n\r\n##### Examples\r\n\r\n    # for Opscode Hosted chef-server use this:\r\n    #chef_set_client_config(:orgname => \"cucumber-chef\")\r\n\r\n    # for Opscode OS chef-server on the Cucumber-Chef test lab use this:\r\n    chef_set_client_config(:chef_server_url => \"http://192.168.255.254:4000\",\r\n                           :validation_client_name => \"chef-validator\")\r\n\r\n## Running Tests\r\n\r\nYou can write the tests and Chef code wherever you like.  We're assuming you prefer working on your local machine, and checking into version control.  But we don't really care.  When it's time to run tests, Cucumber-Chef provides a task which handles this:\r\n\r\n    $ cucumber-chef test myproject\r\n\r\nYou can now pass in options for cucumber or even setup profiles via `cucumber.yml`.  Any command-line options specified after the project name will be passed on to cucumber.  For example:\r\n\r\n    $ cucumber-chef test myproject --tags @wip -c -v -b\r\n\r\nTo take advantage of cucumber profiles, create a `cucumber.yml` configuration file in your `.cucumber-chef` directory off your chef-repo.  In this file you can take full advantage of the Cucumber profiles as definied on their wiki, https://github.com/cucumber/cucumber/wiki/cucumber.yml.\r\n\r\n    └── .cucumber-chef/\r\n        └── cucumber.yml\r\n\r\nHere is an example `cucumber.yml` which turns on colored output, verbosity and full backtraces for all test runs:\r\n\r\n    ---\r\n    default: -c -v -b\r\n\r\nRunning the test task will upload your current project to the test lab, and run the tests, reporting the results back to the screen. Cucumber-chef also provides an upload task, so you can push the current project to the test lab, and then connect to test lab yourself to run tests in a more granular way.  To do this, you need to know the IP of the test lab.  You can find this out by running:\r\n\r\n    $ cucumber-chef info\r\n\r\nAt present, Cucumber-Chef only allows one test lab per AWS account.  In practice, this has not been a constraint.  LXC is incredibly lightweight, and a large number of containers can be provisioned on even a small EC2 instance.\r\n\r\n### When Things Go Oh So Wrong\r\n\r\nWe have put in a few tasks to help you diagnose any issues you may come across with the test lab, containers or your cookbooks and recipes.  There are two main tasks available to help you with this: `ssh` and `diagnose`.\r\n\r\n* `ssh`\r\n\r\nThis command provides you with a rapid way to connect to either your test lab or containers.  Think `vagrant ssh`; we took a queue from their wonderful gem and realized we want our gem to provide the same sort of functionality.  The main difference between our `ssh` task and the way Vagrant's task works is that we generate a fresh ssh key pair whenever a test lab is setup; so you can rest assured no one else has a copy of the credientials.  You also do not have to worry about generating or specifying your own key pair to override a default key pair as is the case with Vagrant if you do not want to use the one shipped with Vagrant.\r\n\r\n    $ cucumber-chef ssh\r\n    Attempting SSH connection to cucumber-chef 'test lab'...\r\n          _____                           _                _____ _           __\r\n         / ____|                         | |              / ____| |         / _|\r\n        | |    _   _  ___ _   _ _ __ ___ | |__   ___ _ __| |    | |__   ___| |_\r\n        | |   | | | |/ __| | | | '_ ` _ \\| '_ \\ / _ \\ '__| |    | '_ \\ / _ \\  _|\r\n        | |___| |_| | (__| |_| | | | | | | |_) |  __/ |  | |____| | | |  __/ |\r\n         \\_____\\__,_|\\___|\\__,_|_| |_| |_|_.__/ \\___|_|   \\_____|_| |_|\\___|_|\r\n\r\n\r\n        Welcome to the Cucumber Chef Test Lab v2.0.0.rc1\r\n\r\n    Last login: Mon Jun  4 07:56:40 2012 from [REDACTED]\r\n    ubuntu@cucumber-chef:~$\r\n\r\nKeep in mind with Amazon's EC2 the base `ubuntu` user is already in the sudoers file; so you can `sudo su -` without needing the password.\r\n\r\n    ubuntu@cucumber-chef:~$ sudo su -\r\n    root@cucumber-chef:~#\r\n\r\nYou can also specify a container name to SSH directly into that container.  For now you are always logged in as `root` when you SSH to a container.\r\n\r\n    $ cucumber-chef ssh devopserver\r\n    Attempting SSH connection to cucumber-chef container 'devopserver'...\r\n          _____                           _                _____ _           __\r\n         / ____|                         | |              / ____| |         / _|\r\n        | |    _   _  ___ _   _ _ __ ___ | |__   ___ _ __| |    | |__   ___| |_\r\n        | |   | | | |/ __| | | | '_ ` _ \\| '_ \\ / _ \\ '__| |    | '_ \\ / _ \\  _|\r\n        | |___| |_| | (__| |_| | | | | | | |_) |  __/ |  | |____| | | |  __/ |\r\n         \\_____\\__,_|\\___|\\__,_|_| |_| |_|_.__/ \\___|_|   \\_____|_| |_|\\___|_|\r\n\r\n\r\n        Welcome to the Cucumber Chef Test Lab v2.0.0.rc1\r\n\r\n        You are now logged in to the LXC 'devopserver'\r\n\r\n    root@devopserver:~#\r\n\r\n* `diagnose`\r\n\r\nThis command provides you with a rapid way to get to the chef-client logs without needing to SSH into a container.  There are a few basic options with this task, let's take a look at them.\r\n\r\n    $ cucumber-chef help diagnose\r\n    Usage:\r\n      cucumber-chef diagnose <container>\r\n\r\n    Options:\r\n      -n, [--lines=N]  # output the last N lines of the chef-client 'chef.log'\r\n                       # Default: 1\r\n      -s, [--strace]   # output the chef-client 'chef-stacktrace.out'\r\n                       # Default: true\r\n      -l, [--log]      # output the chef-client 'chef.log'\r\n                       # Default: true\r\n\r\n    Provide diagnostics from the chef-client on the specified container.\r\n\r\nWith the default options in effect, this task will output the `chef-stacktrace.out` file along with the last line of the `chef.log` file.  You can of course request as many lines as you desire from the `chef.log` file.  For example to look at the last 1000 lines of only the `chef.log` file you would likely run the task as follows.\r\n\r\n    $ cucumber-chef diagnose devopserver --no-strace -n 1000\r\n\r\nMaybe you only want to view the `chef-stacktrace.out` file?\r\n\r\n    $ cucumber-chef diagnose devopserver --no-log\r\n\r\nMaybe you want to run it with the default options in play; you would likely get some output as follows.\r\n\r\n    $ cucumber-chef diagnose devopserver\r\n    Attempting to collect diagnostic information on cucumber-chef container 'sysopserver'...\r\n    ----------------------------------------------------------------------------\r\n    chef-stacktrace.out:\r\n    ----------------------------------------------------------------------------\r\n    Generated at 2012-06-04 08:30:20 +0000\r\n    Net::HTTPServerException: 412 \"Precondition Failed\"\r\n    /opt/opscode/embedded/lib/ruby/1.9.1/net/http.rb:2303:in `error!'\r\n    /opt/opscode/embedded/lib/ruby/gems/1.9.1/gems/chef-0.10.10/lib/chef/rest.rb:264:in `block in api_request'\r\n    /opt/opscode/embedded/lib/ruby/gems/1.9.1/gems/chef-0.10.10/lib/chef/rest.rb:328:in `retriable_rest_request'\r\n    /opt/opscode/embedded/lib/ruby/gems/1.9.1/gems/chef-0.10.10/lib/chef/rest.rb:240:in `api_request'\r\n    /opt/opscode/embedded/lib/ruby/gems/1.9.1/gems/chef-0.10.10/lib/chef/rest.rb:139:in `post_rest'\r\n    /opt/opscode/embedded/lib/ruby/gems/1.9.1/gems/chef-0.10.10/lib/chef/client.rb:313:in `sync_cookbooks'\r\n    /opt/opscode/embedded/lib/ruby/gems/1.9.1/gems/chef-0.10.10/lib/chef/client.rb:194:in `setup_run_context'\r\n    /opt/opscode/embedded/lib/ruby/gems/1.9.1/gems/chef-0.10.10/lib/chef/client.rb:162:in `run'\r\n    /opt/opscode/embedded/lib/ruby/gems/1.9.1/gems/chef-0.10.10/lib/chef/application/client.rb:254:in `block in run_application'\r\n    /opt/opscode/embedded/lib/ruby/gems/1.9.1/gems/chef-0.10.10/lib/chef/application/client.rb:241:in `loop'\r\n    /opt/opscode/embedded/lib/ruby/gems/1.9.1/gems/chef-0.10.10/lib/chef/application/client.rb:241:in `run_application'\r\n    /opt/opscode/embedded/lib/ruby/gems/1.9.1/gems/chef-0.10.10/lib/chef/application.rb:70:in `run'\r\n    /opt/opscode/embedded/lib/ruby/gems/1.9.1/gems/chef-0.10.10/bin/chef-client:26:in `<top (required)>'\r\n    /usr/bin/chef-client:19:in `load'\r\n    /usr/bin/chef-client:19:in `<main>'\r\n    ----------------------------------------------------------------------------\r\n    chef.log:\r\n    ----------------------------------------------------------------------------\r\n    [Mon, 04 Jun 2012 08:30:20 +0000] FATAL: Net::HTTPServerException: 412 \"Precondition Failed\"\r\n\r\n### Example Test Run\r\n\r\nHere is an example of using Cucumber-Chef to do a basic test.  In this test we will provision a server called `devopserver` and apply the `chef-client::service` recipe from the `chef-client` community cookbook.  This example assumes you have your test lab provisioned and up and running.  First things first, make sure you've downloaded the `chef-client` community cookbook and placed it in your chef-repo.\r\n\r\nNow upload the `chef-client` community cookbook to your Cucumber-Chef test lab.\r\n\r\n    $ cc-knife cookbook upload chef-client\r\n    Uploading chef-client             [1.1.2]\r\n    Uploaded 1 cookbook.\r\n\r\nNext create your `devopserver` feature.\r\n\r\n    $ cucumber-chef create devopserver\r\n\r\nHere is the feature we'll be using.  This feature has some extra scenarios to illustrate how you might go about testing other parts of a system.  Go into the features directory of your chef-repo and replace the contents of the `devopserver.feature` file with the text below.\r\n\r\n    @devop\r\n    Feature: Do test driven infrastructure with Cucumber-Chef\r\n      In order to learn how to develop test driven infrastructure\r\n      As an infrastructure developer\r\n      I want to better understand how to use Cucumber-Chef\r\n\r\n      Background:\r\n        * I have a server called devopserver\r\n        * devopserver is persistant\r\n        * devopserver has an IP address of 192.168.10.10\r\n        * devopserver has been provisioned\r\n        * the chef-client::service recipe has been added to the devopserver run list\r\n        * the chef-client has been run on devopserver\r\n        * I have no public keys set\r\n        * I ssh to devopserver with the following credentials:\r\n          | username | password |\r\n          | root     | root     |\r\n\r\n      Scenario: Can connect to the provisioned server via SSH password authentication\r\n        When I run \"hostname\"\r\n        Then I should see \"devopserver\" in the output\r\n\r\n      Scenario: Default root shell is bash\r\n        When I run \"echo $SHELL\"\r\n        Then I should see \"bash\" in the output\r\n\r\n      Scenario: Default gateway and resolver are using Cucumber-Chef Test Lab\r\n        When I run \"route -n | grep 'UG'\"\r\n          Then I should see \"192.168.255.254\" in the output\r\n        When I run \"cat /etc/resolv.conf\"\r\n          Then I should see \"192.168.255.254\" in the output\r\n          And I should see \"8.8.8.8\" in the output\r\n          And I should see \"8.8.4.4\" in the output\r\n\r\n      Scenario: Primary interface is configured with my IP address and MAC address\r\n        When I run \"ifconfig eth0\"\r\n          Then I should see the IP of devopserver in the output\r\n          And I should see the MAC of devopserver in the output\r\n\r\n      Scenario: Local interface is not configured with my IP address or MAC address\r\n        When I run \"ifconfig lo\"\r\n          Then I should see \"127.0.0.1\" in the output\r\n          And I should not see the IP of devopserver in the output\r\n          And I should not see the MAC of devopserver in the output\r\n\r\n      Scenario: Chef-Client is running as a daemon\r\n        When I run \"ps aux | grep [c]hef-client\"\r\n          Then I should see \"chef-client\" in the output\r\n          And I should see \"-d\" in the output\r\n          And I should see \"-i 1800\" in the output\r\n          And I should see \"-s 20\" in the output\r\n\r\nNow we're going to execute the test.  I've tagged the feature with `@devop`, so be sure to pass that to the test runner so Cucumber knows to only run tests tagged with that.\r\n\r\n    $ cucumber-chef test --tags @devop\r\n    Using features directory: /home/[REDACTED]/code/chef-repo/features\r\n    Cucumber-Chef Test Runner Initalized!\r\n    Cleaning up any previous test runs...done.\r\n    Uploading files required for this test run...done.\r\n    Executing Cucumber-Chef Test Runner\r\n    Using the default profile...\r\n    Code:\r\n      * /home/ubuntu/features/support/env.rb\r\n      * /home/ubuntu/features/step_definitions/devopserver_steps.rb\r\n\r\n    Features:\r\n      * /home/ubuntu/features/devopserver.feature\r\n    Parsing feature files took 0m0.075s\r\n\r\n    @devop\r\n    Feature: Do test driven infrastructure with Cucumber-Chef\r\n      In order to learn how to develop test driven infrastructure\r\n      As an infrastructure developer\r\n      I want to better understand how to use Cucumber-Chef\r\n\r\n      Background:                                                                    # /home/ubuntu/features/devopserver.feature:7\r\n        * all servers are being destroyed\r\n        * I have a server called devopserver                                         # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/provision_steps.rb:1\r\n        * devopserver is persistant                                                  # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/provision_steps.rb:5\r\n        * devopserver has an IP address of 192.168.10.10                             # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/provision_steps.rb:9\r\n        * devopserver is being provisioned\r\n        * devopserver has been provisioned                                           # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/provision_steps.rb:17\r\n        * the chef-client::service recipe has been added to the devopserver run list # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/provision_steps.rb:25\r\n        * the chef-client has been run on devopserver                                # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/provision_steps.rb:29\r\n        * I have no public keys set                                                  # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:1\r\n        * I ssh to devopserver with the following credentials:                       # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:56\r\n          | username | password |\r\n          | root     | root     |\r\n\r\n      Scenario: Can connect to the provisioned server via SSH password authentication # /home/ubuntu/features/devopserver.feature:19\r\n        When I run \"hostname\"                                                         # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:76\r\n        Then I should see \"devopserver\" in the output                                 # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:80\r\n\r\n      Scenario: Default root shell is bash                                           # /home/ubuntu/features/devopserver.feature:23\r\n        When I run \"echo $SHELL\"                                                     # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:76\r\n        Then I should see \"bash\" in the output                                       # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:80\r\n\r\n      Scenario: Default gateway and resolver are using Cucumber-Chef Test Lab        # /home/ubuntu/features/devopserver.feature:27\r\n        When I run \"route -n | grep 'UG'\"                                            # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:76\r\n        Then I should see \"192.168.255.254\" in the output                            # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:80\r\n        When I run \"cat /etc/resolv.conf\"                                            # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:76\r\n        Then I should see \"192.168.255.254\" in the output                            # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:80\r\n        And I should see \"8.8.8.8\" in the output                                     # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:80\r\n        And I should see \"8.8.4.4\" in the output                                     # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:80\r\n\r\n      Scenario: Primary interface is configured with my IP address and MAC address   # /home/ubuntu/features/devopserver.feature:35\r\n        When I run \"ifconfig eth0\"                                                   # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:76\r\n        Then I should see the IP of devopserver in the output                        # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:88\r\n        And I should see the MAC of devopserver in the output                        # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:88\r\n\r\n      Scenario: Local interface is not configured with my IP address or MAC address  # /home/ubuntu/features/devopserver.feature:40\r\n        When I run \"ifconfig lo\"                                                     # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:76\r\n        Then I should see \"127.0.0.1\" in the output                                  # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:80\r\n        And I should not see the IP of devopserver in the output                     # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:92\r\n        And I should not see the MAC of devopserver in the output                    # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:92\r\n\r\n      Scenario: Chef-Client is running as a daemon                                   # /home/ubuntu/features/devopserver.feature:46\r\n        When I run \"ps aux | grep [c]hef-client\"                                     # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:76\r\n        Then I should see \"chef-client\" in the output                                # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:80\r\n        And I should see \"-d\" in the output                                          # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:80\r\n        And I should see \"-i 1800\" in the output                                     # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:80\r\n        And I should see \"-s 20\" in the output                                       # cucumber-chef-2.0.0.rc1/lib/cucumber/chef/steps/ssh_steps.rb:80\r\n\r\n    6 scenarios (6 passed)\r\n    70 steps (70 passed)\r\n    2m8.459s\r\n\r\nIf all goes well you should see output similar to what's above!  Enjoy and have fun!\r\n\r\n# LINKS\r\n\r\nSource:\r\n\r\n* https://github.com/Atalanta/cucumber-chef\r\n\r\nIssues:\r\n\r\n* https://github.com/Atalanta/cucumber-chef/issues\r\n\r\nWiki:\r\n\r\n* https://github.com/Atalanta/cucumber-chef/wiki\r\n\r\n# LICENSE\r\n\r\nCucumber-Chef - A test driven infrastructure system\r\n\r\n* Author: Stephen Nelson-Smith <stephen@atalanta-systems.com>\r\n* Author: Zachary Patten <zachary@jovelabs.com>\r\n* Copyright: Copyright (c) 2011-2012 Cucumber-Chef\r\n* License: Apache License, Version 2.0\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n","tagline":"Framework for test-driven infrastructure development","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}